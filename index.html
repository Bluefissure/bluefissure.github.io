<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Bluefissure&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Bluefissure&#39;s Blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bluefissure&#39;s Blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Bluefissure's Blog</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Bluefissure's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">A Place for Recording</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/17/leetcode-857-minimum-cost-to-hire-k-workers/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/17/leetcode-857-minimum-cost-to-hire-k-workers/" itemprop="url">LeetCode.857 Minimum Cost to Hire K Workers</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-17T14:16:23+00:00">
                2018-10-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><a href="https://leetcode.com/problems/minimum-cost-to-hire-k-workers/" target="_blank" rel="noopener">题目地址</a></p>
<h3 id="题意："><a href="#题意：" class="headerlink" title="题意："></a>题意：</h3><p>n个人，每个人有wage和quality，选择K个人按照quality比发放工资，要求到手的工资不少于各自的wage，求最小花费。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/10/17/leetcode-857-minimum-cost-to-hire-k-workers/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/12/computer-graphics-final-project-simple-raytracing/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/12/computer-graphics-final-project-simple-raytracing/" itemprop="url">Computer Graphics Final Project Simple RayTracing</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-12T11:16:05+00:00">
                2017-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最后一个实验要求做一个RayTracing的小东西，本实验采用了Cornell Box作为模型，实现了简单的tracer。 主要从以下几个方面简单的介绍：</p>
<h1 id="算法框架"><a href="#算法框架" class="headerlink" title="算法框架"></a>算法框架</h1><p><img src="https://bluefissure.com/wp-content/uploads/2017/06/tracing.png" alt=""> 算法伪代码如上，即对每个像素点随机选取光线方向，如果击中点的话对其进行render，并根据反射、折射等递归计算，没有击中点则返回背景颜色。</p>
<h1 id="数学基础"><a href="#数学基础" class="headerlink" title="数学基础"></a>数学基础</h1><p>在实验的过程中，调用glm后发现实际的速度并没有快很多，反而各种方法比较凌乱，因此自己实现了一个Vector的struct： [cpp] #pragma once #include “Calc.h” struct Vec { double x, y, z; Vec(double x_ = 0, double y_ = 0, double z_ = 0) { x = x_; y = y_; z = z_; } Vec operator+(const Vec &amp;amp;amp;amp;b) const { return Vec(x + b.x, y + b.y, z + b.z); } Vec operator-(const Vec &amp;amp;amp;amp;b) const { return Vec(x - b.x, y - b.y, z - b.z); } Vec operator<em>(double b) const { return Vec(x\</em>b, y*b, z*b); } Vec mult(const Vec &amp;amp;amp;amp;b) const { return Vec(x*b.x, y*b.y, z*b.z); } Vec&amp;amp;amp;amp; norm() { return *this = *this <em> (1 / Qsqrt(x\</em>x + y*y + z*z)); } double dot(const Vec &amp;amp;amp;amp;b) const { return x*b.x + y*b.y + z*b.z; } Vec cross(const Vec &amp;amp;amp;amp;rhs) { return Vec(y <em> rhs.z - z </em> rhs.y, z <em> rhs.x - x </em> rhs.z, x <em> rhs.y - y </em> rhs.x); } }; [/cpp] 这里面有个叫做Qsqrt的东西，其实是鼎鼎有名的卡马克常数的那个平方根快速算法，具体解释我可能有时间再写一篇博客探讨下： [cpp] #pragma once float Qsqrt(float number)//By Carmark { int i; float x2, y; const float threehalfs = 1.5F; x2 = number <em> 0.5F; y = number; i = </em>(int <em>)&amp;amp;amp;amp;y; i = 0x5f375a86 - (i &amp;amp;amp;gt;&amp;amp;amp;gt; 1); y = </em>(float <em>)&amp;amp;amp;amp;i; y = y </em> (threehalfs - (x2 <em> y </em> y)); y = y <em> (threehalfs - (x2 </em> y <em> y)); y = y </em> (threehalfs - (x2 <em> y </em> y)); return number*y; } [/cpp]</p>
<h1 id="光线"><a href="#光线" class="headerlink" title="光线"></a>光线</h1><p>光线类，o和d分别表示起始位置和方向 [cpp] #pragma once #include “Vecter.h” struct Ray { Vec o, d; Ray(Vec o_, Vec d_) : o(o_), d(d_) {} }; [/cpp]</p>
<p>球<br>=</p>
<p>之后写了一个叫做Sphere的类，材质包括漫反射、反射与折射，并实现一下与光线相交的函数，返回光线的参数方程（o+td）中第一个交点的t： <img src="https://bluefissure.com/wp-content/uploads/2017/06/sphereinter.png" alt=""> [cpp] #pragma once #include “Ray.h” #include “Calc.h” enum Refl_t { DIFF, SPEC, REFR }; struct Sphere { double rad; Vec p, e, c; // position, emission, color; Refl_t refl; Sphere(double rad_, Vec p_, Vec e_, Vec c_, Refl_t refl_) : rad(rad_), p(p_), e(e_), c(c_), refl(refl_) {} double intersect(const Ray &amp;r) const { // returns distance, 0 if nohit Vec op = p - r.o; double t, eps = 1e-4, b = op.dot(r.d), det = b*b - op.dot(op) + rad*rad; if (det<0) return="" 0;="" else="" det="Qsqrt(det);" (t="b" -="" det)="">eps ? t : ((t = b + det)&gt;eps ? t : 0); } }; [/cpp]</0)></p>
<h1 id="场景构建"><a href="#场景构建" class="headerlink" title="场景构建"></a>场景构建</h1><p>由于当半径很大的时候，球的部分表面可以被看做是平面，因此不必单独写平面的类，直接调用sphere就好。 下面的代码设置了上下左右前后六个表面、灯光和材质分别是反射和折射的两个球： [cpp] Sphere spheres[] = {//Scene: radius, position, emission, color, material Sphere(1e5, Vec(1e5 + 1,40.8,81.6), Vec(),Vec(.75,.25,.25),DIFF),//Left Sphere(1e5, Vec(-1e5 + 99,40.8,81.6),Vec(),Vec(.25,.25,.75),DIFF),//Rght Sphere(1e5, Vec(50,40.8, 1e5), Vec(),Vec(.75,.75,.75),DIFF),//Back Sphere(1e5, Vec(50,40.8,-1e5 + 170), Vec(),Vec(), DIFF),//Frnt Sphere(1e5, Vec(50, 1e5, 81.6), Vec(),Vec(.75,.75,.75),DIFF),//Botm Sphere(1e5, Vec(50,-1e5 + 81.6,81.6),Vec(),Vec(.75,.75,.75),DIFF),//Top Sphere(16.5,Vec(27,16.5,47), Vec(),Vec(1,1,1)<em>.999, SPEC),//Mirr Sphere(16.5,Vec(73,16.5,78), Vec(),Vec(1,1,1)</em>.999, REFR),//Glas Sphere(600, Vec(50,681.6 - .27,81.6),Vec(12,12,12), Vec(), DIFF) //Lite }; [/cpp]</p>
<h1 id="图像、采样率、摄像机的设置"><a href="#图像、采样率、摄像机的设置" class="headerlink" title="图像、采样率、摄像机的设置"></a>图像、采样率、摄像机的设置</h1><p>设置一些基本的图像参数，用于进一步的构建图像： [cpp] int w = 1024, h = 768, samps = 1; Ray cam(Vec(50, 52, 295.6), Vec(0, -0.042612, -1).norm()); // camera position direction Vec cx = Vec(w<em>.5135 / h), cy = (cx.cross(cam.d)).norm()</em>.5135, r, *c = new Vec[w*h]; [/cpp]</p>
<h1 id="循环处理像素点"><a href="#循环处理像素点" class="headerlink" title="循环处理像素点"></a>循环处理像素点</h1><p>对于每个像素点，选取它的四邻域进行随机取样，取样的个数就是采样率的samps： [cpp] for (int y = 0; y&lt;h; y++) { // Rows fprintf(stderr, “\\rRendering (%d spp) %5.2f%%”, samps <em> 4, 100.\</em>y / (h - 1)); for (unsigned short x = 0; x&lt;w; x++) // Cols for (int sy = 0, i = (h - y - 1)*w + x; sy&lt;2; sy++) for (int sx = 0; sx&lt;2; sx++, r = Vec()) { // 2x2 subpixel cols for (int s = 0; s&lt;samps; s++) { //samples double r1 = 2 <em> random(), dx = r1&lt;1 ? sqrt(r1) - 1 : 1 - sqrt(2 - r1); double r2 = 2 </em> random(), dy = r2&lt;1 ? sqrt(r2) - 1 : 1 - sqrt(2 - r2); Vec d = cx<em>(((sx + .5 + dx) / 2 + x) / w - .5) + cy</em>(((sy + .5 + dy) / 2 + y) / h - .5) + cam.d; r = r + radiance(Ray(cam.o + d <em> 140, d.norm()), 0)</em>(1. / samps); } c[i] = c[i] + Vec(clamp(r.x), clamp(r.y), clamp(r.z))*.25; } [/cpp] 其中，radiance就是进行raycast的递归过程，计算之后对各个采样点计算得来的颜色取平均值。  </p>
<h1 id="RayCast过程"><a href="#RayCast过程" class="headerlink" title="RayCast过程"></a>RayCast过程</h1><p>即radiance过程，是一个递归的过程，首先intersect方法得到这个光线击中的物体： [cpp] inline bool intersect(const Ray &amp;r, double &amp;t, int &amp;id) { double n = sizeof(spheres) / sizeof(Sphere), d, inf = t = 1e20; for (int i = int(n); i—;) if ((d = spheres[i].intersect(r)) &amp;&amp; d<t) {="" t="d;" id="i;" }="" return="" t<inf;="" \[="" cpp\]="" 设置了递归的深度是5，得到击中的物体后计算法向量（和背面剔除后的法向量），如果递归超过深度则按照概率衰减或直接返回强度（灯光）="" \[cpp\]="" double="" t;="" int="" if="" (!intersect(r,="" t,="" id))="" vec();="" const="" sphere="" &obj="spheres\[id\];" vec="" x="r.o" +="" r.d\*t,="" n="(x" -="" obj.p).norm(),="" nl="n.dot(r.d)<0" ?="" :="" n\*-1,="" f="obj.c;//n:normal" nl:backface="" culling="" normal="" p="f.x">f.y &amp;&amp; f.x&gt;f.z ? f.x : f.y&gt;f.z ? f.y : f.z; // p:max refl if (++depth&gt;5) if (random()<p) 2017="" f="f*(1" p);="" else="" return="" obj.e;="" \[="" cpp\]="" 之后是漫反射、镜面反射的着色过程，在[之前的博客](https:="" bluefissure.com="" archives="" 320)中有提及，这里不再赘述计算过程。需要注意的是，漫反射之后的来源光线是随机选取的，随机的过程可以用下图表示。="" ![](https:="" wp-content="" uploads="" 06="" hemisphere.png)="" \[cpp\]="" if="" (obj.refl="=" diff)="" {="" double="" r1="2" *="" m_pi\*random(),="" r2="random()," r2s="sqrt(r2);" vec="" w="nl," u="((fabs(w.x)">.1 ? Vec(0, 1) : Vec(1)).cross(w)).norm(), v = w.cross(u); Vec d = (u*cos(r1)*r2s + v*sin(r1)*r2s + w*sqrt(1 - r2)).norm(); return obj.e + f.mult(radiance(Ray(x, d), depth)); } else if (obj.refl == SPEC) return obj.e + f.mult(radiance(Ray(x, r.d - n <em> 2 </em> n.dot(r.d)), depth)) [/cpp] 之后是折射与反射的判断关系……首先要复习一下全反射（Total internal reflection ）的相关知识，判断一下是需要进行全反射就好还是需要进一步计算折射：<img src="https://bluefissure.com/wp-content/uploads/2017/06/totalreflect.png" alt=""> 如果有折射，用下面这张图中的公式计算： <img src="https://bluefissure.com/wp-content/uploads/2017/06/refract.png" alt="">   [cpp] Ray reflRay(x, r.d - n <em> 2 </em> n.dot(r.d)); // Ideal dielectric REFRACTION bool into = n.dot(nl)&gt;0; // Ray from outside going in? double nc = 1, nt = 1.5, nnt = into ? nc / nt : nt / nc, ddn = r.d.dot(nl), cos2t; if ((cos2t = 1 - nnt*nnt*(1 - ddn*ddn))<0) 1="" total="" internal="" reflection="" return="" obj.e="" +="" f.mult(radiance(reflray,="" depth));="" vec="" tdir="(r.d\*nnt" -="" n*((into="" ?="" :="" -1)*(ddn\*nnt="" sqrt(cos2t)))).norm();="" double="" a="nt" nc,="" b="nt" r0="a\*a" (b\*b),="" c="1" (into="" -ddn="" tdir.dot(n));="" re="R0" (1="" r0)\*c\*c\*c\*c\*c,="" tr="1" re,="" p=".25" .5\*re,="" rp="Re" p,="" tp="Tr" p);="" f.mult(depth="">2 ? (random()&lt;P ? // Russian roulette radiance(reflRay, depth)*RP : radiance(Ray(x, tdir), depth)*TP) : radiance(reflRay, depth)*Re + radiance(Ray(x, tdir), depth)*Tr); [/cpp]</0)></p)></t)></p>
<h1 id="最后结果"><a href="#最后结果" class="headerlink" title="最后结果"></a>最后结果</h1><p>输出ppm图像如下： [cpp] FILE *f; errno_t err; err = fopen_s(&amp;f, “image.ppm”, “w”); fprintf(f, “P3\\n%d %d\\n%d\\n”, w, h, 255); for (int i = 0; i&lt;w*h; i++) fprintf(f, “%d %d %d “, toInt(c[i].x), toInt(c[i].y), toInt(c[i].z)); [/cpp]   采样率低的时候噪点很多，随着采样率升高效果逐渐平滑和稳定： <img src="https://bluefissure.com/wp-content/uploads/2017/06/4ssp-1024x768.jpg" alt=""> <img src="https://bluefissure.com/wp-content/uploads/2017/06/48ssp-1024x768.jpg" alt=""><img src="https://bluefissure.com/wp-content/uploads/2017/06/500-1024x768.jpg" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/22/computer-graphics-experiment-iii-part-2-lightmodel-in-opengl-inplemented-via-glsl/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/22/computer-graphics-experiment-iii-part-2-lightmodel-in-opengl-inplemented-via-glsl/" itemprop="url">Computer Graphics Experiment III Part.2 LightModel in OpenGL (Inplemented via GLSL)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-22T10:36:03+00:00">
                2017-05-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>图形学实验三第二部分——GLSL实现的三种光照模型。 此次试验用GLSL（OpenGL Shading Language）着色语言实现OpenGL自带的光照模型，比较不同的着色方法带来的不同。</p>
<h1 id="点的着色过程"><a href="#点的着色过程" class="headerlink" title="点的着色过程"></a>点的着色过程</h1><p>首先，对某个点的计算光照的方法如下:</p>
<h2 id="环境光-Ambient-与漫反射-Diffuse"><a href="#环境光-Ambient-与漫反射-Diffuse" class="headerlink" title="环境光(Ambient)与漫反射(Diffuse)"></a>环境光(Ambient)与漫反射(Diffuse)</h2><p><img src="https://bluefissure.com/wp-content/uploads/2017/06/ambientdiff-1024x335.png" alt=""> 即环境光直接是环境光，漫反射经过反射（由于是单位向量直接取内积）后反射到所有方向。 其中$k$是衰减因子，在实验中忽略了。   [cpp] // Ambient float ambientStrength = 0.1f; vec3 ambient = ambientStrength <em> lightColor; // Diffuse vec3 norm = normalize(Normal); vec3 lightDir = normalize(lightPos - FragPos); float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff </em> lightColor; [/cpp]</p>
<h2 id="镜面反射"><a href="#镜面反射" class="headerlink" title="镜面反射"></a>镜面反射</h2><p><img src="https://bluefissure.com/wp-content/uploads/2017/06/spec-1024x631.png" alt=""> 如图，镜面反射需要先计算反射光的方向，再乘以与视线向量的夹角的余弦值，其中余弦值以高光系数$n_{shiny}$作幂次。 反射光$R$的方向可以由下图求得<img src="https://bluefissure.com/wp-content/uploads/2017/06/relect-1024x585.png" alt=""> 也可以直接在GLSL中调用relect()函数，该函数接收入射光方向和法向量，返回反射后的光线方向：   [cpp] // Specular float specularStrength = 0.5f; vec3 viewDir = normalize(viewPos - FragPos); vec3 reflectDir = reflect(-lightDir, norm); float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32); vec3 specular = specularStrength <em> spec </em> lightColor; [/cpp]</p>
<h1 id="Gouraud着色"><a href="#Gouraud着色" class="headerlink" title="Gouraud着色"></a>Gouraud着色</h1><p>Gouraud着色为只对三角面片的顶点计算着色，其他的点通过插值计算颜色，GLSL中的顶点和片段着色器分别如下： [cpp] //gouraudShader.vs #version 330 core layout (location = 0) in vec3 position; layout (location = 1) in vec3 normal; out vec3 LightingColor; // resulting color from lighting calculations uniform vec3 lightPos; uniform vec3 viewPos; uniform vec3 lightColor; uniform mat4 model; uniform mat4 view; uniform mat4 projection; void main() { gl_Position = projection <em> view </em> model <em> vec4(position, 1.0); // gouraud shading // ———————————— vec3 Position = vec3(model </em> vec4(position, 1.0)); vec3 Normal = mat3(transpose(inverse(model))) <em> normal; // ambient float ambientStrength = 0.1; vec3 ambient = ambientStrength </em> lightColor; // diffuse vec3 norm = normalize(Normal); vec3 lightDir = normalize(lightPos - Position); float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff <em> lightColor; // specular float specularStrength = 1.0; // this is set higher to better show the effect of Gouraud shading vec3 viewDir = normalize(viewPos - Position); vec3 reflectDir = reflect(-lightDir, norm); float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32); vec3 specular = specularStrength </em> spec <em> lightColor; LightingColor = ambient + diffuse + specular; } [/cpp] 顶点着色器计算之后传入片段着色器后会自动对顶点着色器的输出进行插值。 [cpp] //gouraudShader.frag #version 330 core out vec4 FragColor; in vec3 LightingColor; uniform vec3 objectColor; void main() { FragColor = vec4(LightingColor </em> objectColor, 1.0); } [/cpp] 结果演示如下，可以看出明显的区域和插值结果： [video width=”800” height=”600” mp4=”<a href="https://bluefissure.com/wp-content/uploads/2017/06/GouraudShading.mp4&quot;\]\[/video\" target="_blank" rel="noopener">https://bluefissure.com/wp-content/uploads/2017/06/GouraudShading.mp4&quot;\]\[/video\</a>]</p>
<h1 id="Phong着色"><a href="#Phong着色" class="headerlink" title="Phong着色"></a>Phong着色</h1><p>和Gouraud着色不同，Phong着色则是对法向量进行插值，之后对每个点计算光照，因此，光照的计算是在片段着色器中： [cpp] //PhongShader.vs #version 330 core layout (location = 0) in vec3 position; layout (location = 1) in vec3 normal; out vec3 Normal; out vec3 FragPos; uniform mat4 model; uniform mat4 view; uniform mat4 projection; void main() { gl_Position = projection <em> view </em> model <em> vec4(position, 1.0f); FragPos = vec3(model </em> vec4(position, 1.0f)); Normal = mat3(transpose(inverse(model))) <em> normal; } [/cpp] [cpp] //PhongShader.frag #version 330 core out vec4 color; in vec3 FragPos; in vec3 Normal; uniform vec3 lightPos; uniform vec3 viewPos; uniform vec3 lightColor; uniform vec3 objectColor; void main() { // Ambient float ambientStrength = 0.1f; vec3 ambient = ambientStrength </em> lightColor; // Diffuse vec3 norm = normalize(Normal); vec3 lightDir = normalize(lightPos - FragPos); float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff <em> lightColor; // Specular float specularStrength = 0.5f; vec3 viewDir = normalize(viewPos - FragPos); vec3 reflectDir = reflect(-lightDir, norm); float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32); vec3 specular = specularStrength </em> spec <em> lightColor; vec3 result = (ambient + diffuse + specular) </em> objectColor; color = vec4(result, 1.0f); } [/cpp] 结果是最好的： [video width=”800” height=”600” mp4=”<a href="https://bluefissure.com/wp-content/uploads/2017/06/PhongShading.mp4&quot;\]\[/video\" target="_blank" rel="noopener">https://bluefissure.com/wp-content/uploads/2017/06/PhongShading.mp4&quot;\]\[/video\</a>]</p>
<h1 id="Flat着色"><a href="#Flat着色" class="headerlink" title="Flat着色"></a>Flat着色</h1><p>Flat就比较Naive了，每一个三角面片只计算一个光照，并将这个光照当做这个三角面片的光照： [cpp] //FlatShader.vs #version 330 core layout (location = 0) in vec3 position; layout (location = 1) in vec3 normal; flat out vec3 LightingColor; uniform vec3 lightPos; uniform vec3 viewPos; uniform vec3 lightColor; uniform mat4 model; uniform mat4 view; uniform mat4 projection; void main() { gl_Position = projection <em> view </em> model <em> vec4(position, 1.0); // flat shading // ———————————— vec3 Position = vec3(model </em> vec4(position, 1.0)); vec3 Normal = mat3(transpose(inverse(model))) <em> normal; // ambient float ambientStrength = 0.1; vec3 ambient = ambientStrength </em> lightColor; // diffuse vec3 norm = normalize(Normal); vec3 lightDir = normalize(lightPos - Position); float diff = max(dot(norm, lightDir), 0.0); vec3 diffuse = diff <em> lightColor; // specular float specularStrength = 1.0; vec3 viewDir = normalize(viewPos - Position); vec3 reflectDir = reflect(-lightDir, norm); float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32); vec3 specular = specularStrength </em> spec <em> lightColor; LightingColor = ambient + diffuse + specular; } [/cpp] [cpp] //FlatShader.frag #version 330 core flat in vec3 LightingColor; layout( location = 0 ) out vec4 FragColor; uniform vec3 objectColor; void main() { FragColor = vec4(LightingColor </em> objectColor, 1.0); } [/cpp] 结果有明显的马赫带（x [video width=”800” height=”600” mp4=”<a href="https://bluefissure.com/wp-content/uploads/2017/06/FlatShading.mp4&quot;\]\[/video\" target="_blank" rel="noopener">https://bluefissure.com/wp-content/uploads/2017/06/FlatShading.mp4&quot;\]\[/video\</a>]</p>
<h1 id="三种着色方法比较"><a href="#三种着色方法比较" class="headerlink" title="三种着色方法比较"></a>三种着色方法比较</h1><p>进一步看一下比较： [video width=”800” height=”600” mp4=”<a href="https://bluefissure.com/wp-content/uploads/2017/06/AllTogether.mp4&quot;\]\[/video\" target="_blank" rel="noopener">https://bluefissure.com/wp-content/uploads/2017/06/AllTogether.mp4&quot;\]\[/video\</a>]</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/20/computer-graphics-experiment-iii-part-1-lightmodel-in-opengl-based-on-walkingman/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/20/computer-graphics-experiment-iii-part-1-lightmodel-in-opengl-based-on-walkingman/" itemprop="url">Computer Graphics Experiment III Part.1 LightModel in OpenGL (based on WalkingMan)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-20T23:59:27+00:00">
                2017-04-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>图形学实验三第一部分——实验二基础上的光照模型。 此次试验首先在上一个实验的基础上实现OpenGL自带的光照模型，比较不同的着色方法带来的不同，之后再通过GLSL写着色器实现两种不同的光照模型。 本篇博客首先在上一个实验：<a href="https://bluefissure.com/archives/247" target="_blank" rel="noopener">WalkMan</a> 的基础上添加光照，并使用两种不同的着色方法。</p>
<h2 id="光照模型"><a href="#光照模型" class="headerlink" title="光照模型"></a>光照模型</h2><p>OpenGL中的光照模型中的反射光分为三个分量，分别是环境反射光（Ambient Light）、漫反射光（Diffuse Light）和镜面反射光（Specular Light）。</p>
<ul>
<li><p>环境光Ambient：是由光源发出经环境多次散射而无法确定其入射方向的光，即似乎来自所有方向。其特征是入射方向和出射方向均为任意方向。</p>
</li>
<li><p>漫射光Diffuse：来自特定方向，它垂直于物体时比倾斜时更明亮。一旦它照射到物体上，则在各个方向上均匀地发散出去，效果为无论视点在哪里它都一样亮，其特征是入射方向唯一、出射方向为任意方向。</p>
</li>
<li><p>镜面光Specular：来自特定方向并沿另一方向反射出去，一个平行激光束在高质量的镜面上产生100%的镜面反射，其特征是入射方向和出射方向均唯一。</p>
</li>
</ul>
<h2 id="创建光源"><a href="#创建光源" class="headerlink" title="创建光源"></a><strong>创建光源</strong></h2><p>OpenGL中用函数glLightfv来创建光源，函数原型是： [cpp] void glLightfv (GLenum light, GLenum pname, const GLfloat *params) [/cpp] 第一个参数light指定所创建的光源号，如GL_LIGHT0、GL_LIGHT1、…、GL_LIGHT7。 第二个参数pname指定光源特性，这个参数的具体信息见下表所示。 <img src="https://bluefissure.com/wp-content/uploads/2017/04/pname.png" alt=""> 第三个参数设置相应的光源特性值。 如下，我们便可以定义一个位置在(5,5,5)没有环境光，镜面反射光和漫反射光都为白光的光源 [cpp] GLfloat light_ambient[] = { 0.0, 0.0, 0.0, 1.0 }; GLfloat light_diffuse[] = { 1.0, 1.0, 1.0, 1.0 }; GLfloat light_specular[] = { 1.0, 1.0, 1.0, 1.0 }; GLfloat light_position[] = { 5,5,5,0 }; glLightfv(GL_LIGHT0, GL_POSITION, light_position); glLightfv(GL_LIGHT0, GL_AMBIENT, light_ambient); glLightfv(GL_LIGHT0, GL_DIFFUSE, light_diffuse); glLightfv(GL_LIGHT0, GL_SPECULAR, light_specular); [/cpp] 其中，position是其次坐标系，当第四个参数为0时，表示点光源，为1时表示由前三个数组成向量射来的平型光源。</p>
<h2 id="Phong-Model与Flat-Model"><a href="#Phong-Model与Flat-Model" class="headerlink" title="Phong Model与Flat Model"></a>Phong Model与Flat Model</h2><p>我们用下列代码控制关照的模式 [cpp] if (!smooth) glShadeModel(GL_FLAT); else glShadeModel(GL_SMOOTH); [/cpp] 然后光照模型的对比如下： <img src="https://bluefissure.com/wp-content/uploads/2017/04/smooth.png" alt=""> <img src="https://bluefissure.com/wp-content/uploads/2017/04/flat.png" alt=""> 可见，FLAT模式下出现了明显的马赫带。 新版本的OpenGL提供了更加自由的渲染模式，我们在<a href="https://bluefissure.com/archives/320" target="_blank" rel="noopener">下一篇博客</a>中将利用其通过不同的Model渲染新的场景。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/18/about-the-forum-with-mr-coordinate-song/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/18/about-the-forum-with-mr-coordinate-song/" itemprop="url">About the forum with Mr. Coordinate Song</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-18T10:09:45+00:00">
                2017-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>下面对前几天去青岛和学校学生工作部的副部长宋部长（Coordinate Song）座谈会的笔记简单整理下，跟大家汇报下工作： 座谈会邀请了本科和研究生（博士生）各10人左右，所谈内容有关于本科生的，主要是搬迁至青岛校区后的学习、生活、发展三个问题，本文记录也先暂时按照这三个方面对青岛校区的各项方面和本次座谈会的内容做一下简短的介绍：</p>
<h2 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h2><h3 id="校区建设情况（虽然基本啥都没建好）"><a href="#校区建设情况（虽然基本啥都没建好）" class="headerlink" title="校区建设情况（虽然基本啥都没建好）"></a>校区建设情况（虽然基本啥都没建好）</h3><p>先看下规划图 <img src="https://bluefissure.com/wp-content/uploads/2017/04/guihua.jpg" alt=""> 然后目前已经启用（并没）的一期工程是红色圈出来的区域<img src="https://bluefissure.com/wp-content/uploads/2017/04/yiqi.jpg" alt=""> 根据我的会议笔记，大体上目前的进度如下：</p>
<ul>
<li>图书馆（10月份竣工）： 国内最大【</li>
<li>青岛政府代建: 体育馆（风雨操场）：未动工 博物馆：</li>
<li>创新实验室： 应该会都予以保留</li>
<li>餐厅： 目前开放了一层，将来三层（</li>
<li>综合服务楼： 原计划十月份竣工（</li>
<li>轻轨： 年底通车</li>
</ul>
<h3 id="生活硬件设施"><a href="#生活硬件设施" class="headerlink" title="生活硬件设施"></a>生活硬件设施</h3><p>宿舍条件还是不错的，照片就不放了，想看去群相册里可以看到，主要包括</p>
<ul>
<li>形体训练室（ww： 女生宿舍才有</li>
<li>自助厨房： 不允许用油，可以烤、蒸、煮 不允许明火 不提倡做正餐</li>
<li>直饮水： 直饮水机蛮多的，基本不用拿暖瓶</li>
<li>洗衣房： 6-8kg ￥3  熨烫机 洗鞋机（</li>
<li>宿舍卫生： 要会刷马桶（……），大概是因为是独立卫浴什么的吧</li>
<li>独立卫浴： 有</li>
<li>空调： 空调？不需要的（据说有需要再加</li>
</ul>
<h3 id="学校周边"><a href="#学校周边" class="headerlink" title="学校周边"></a>学校周边</h3><ul>
<li>东里村：（我不是来搞笑的 商场啥的（因为学校的商场（综合服务楼）还没建好</li>
<li>东边的海水浴场： 不建议去游泳，暗流涌动易伤人（</li>
<li>港中旅： 这个看起来很6，宋部长好像没说，反正我去不起（x</li>
<li>别的没了</li>
</ul>
<h2 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h2><p>学习方面本科生采用书院制，个人认为就是把不同学院搞成一起玩的一个管理模式，淡化学院制的培养模式，下面是我的笔记，大家看看就好……</p>
<ol>
<li>师生关系：导师培养制度 一个导师最多十个本科生 辅导员也在宿舍楼内办公</li>
<li>同学关系： 不同学院的同学间交流 淡化学院间同学隔阂 基本没有学院单独的学生组织（ 男女生有序交流（宿舍同层开个门就可能看到啥的）， 交流室 书院提供的服务设施 通识教育 宿舍不同学院【好辣鸡啊【目前并没实行 监督管理由学生负责： 学生会、自我管理委员会、自我监督委员会（纪委喵喵喵？（达康书记！</li>
</ol>
<h2 id="发展"><a href="#发展" class="headerlink" title="发展"></a>发展</h2><p>开会没说，我们提了诸如语言考试考点、校招等等问题和意见后他表示嗯嗯很有道理这些都是需要解决的问题（(╯‵□′)╯︵┻━┻</p>
<h2 id="搬迁"><a href="#搬迁" class="headerlink" title="搬迁"></a>搬迁</h2><ol>
<li>搬迁人员信息 前些天统计的信息是用来录入数据库、然后大家自选床位房间用的，基本是自己去网上选择房间床位，辅导员协助。 这样可能存在六人间变成四人间的各种去留问题，大概是需要大家协商或辅导员协助叭（</li>
<li>时间安排 7.10开始搬迁，三天的时间完成</li>
<li>具体实施方案<ul>
<li>人和东西分开搬：7.10东西来人不来，东西会放到选好的床位上，人九月份才能来（也就是提前来了也不能住（也就是辣鸡到不行（济南青岛无一处容身之地（可能会在济南保留有需要的同学的床位的吧（不知</li>
<li>每人给1~2条邮政保密袋，建议把不适合长途运的东西都处理掉或人工搬，没有搬迁补助</li>
</ul>
</li>
<li>搬迁手册 搬迁手册里应该有具体的实施方案，做好后会发给大家（并不是我做</li>
</ol>
<h2 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h2><p>宋部长要统计关于搬迁的问题，写了个<a href="https://wj.qq.com/s/1286128/3b52/" target="_blank" rel="noopener">表单</a>大家可以去填（表单不是官方的（只是统计下（当然也不一定只提关于搬迁的问题，刚才说的生活学习发展的问题都能提 填的问题可以提前在班群里询问下，如果我能解答尽量给大家解答</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/06/computer-graphics-experiment-ii-part-2-3d-boxman/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/06/computer-graphics-experiment-ii-part-2-3d-boxman/" itemprop="url">Computer Graphics Experiment II Part.2 3D Boxman</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-06T00:32:48+00:00">
                2017-04-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>图形学实验二第二部分——智障的3D小人 demo以及相机相关请看上一篇博文——<a href="https://bluefissure.com/archives/247" target="_blank" rel="noopener">3D Touring</a></p>
<h2 id="绘图基本函数"><a href="#绘图基本函数" class="headerlink" title="绘图基本函数"></a>绘图基本函数</h2><p>首先要实现个画正方体和长方体的函数，正方体是直接画六个面，长方体则是更改了scale后的画正方体。 [cpp] void drawCube(double xPos, double yPos, double zPos) { glPushMatrix(); glTranslated(xPos, yPos, zPos); glBegin(GL_POLYGON); glVertex3d(0.0f, 0.0f, 0.0f); //顶面 glVertex3d(0.0f, 0.0f, -1.0f); glVertex3d(-1.0f, 0.0f, -1.0f); glVertex3d(-1.0f, 0.0f, 0.0f); glVertex3d(0.0f, 0.0f, 0.0f); //正面 glVertex3d(-1.0f, 0.0f, 0.0f); glVertex3d(-1.0f, -1.0f, 0.0f); glVertex3d(0.0f, -1.0f, 0.0f); glVertex3d(0.0f, 0.0f, 0.0f); //右面 glVertex3d(0.0f, -1.0f, 0.0f); glVertex3d(0.0f, -1.0f, -1.0f); glVertex3d(0.0f, 0.0f, -1.0f); glVertex3d(-1.0f, 0.0f, 0.0f); //左面 glVertex3d(-1.0f, 0.0f, -1.0f); glVertex3d(-1.0f, -1.0f, -1.0f); glVertex3d(-1.0f, -1.0f, 0.0f); glVertex3d(0.0f, -1.0f, 0.0f); //底面 glVertex3d(0.0f, -1.0f, -1.0f); glVertex3d(-1.0f, -1.0f, -1.0f); glVertex3d(-1.0f, -1.0f, 0.0f); glVertex3d(0.0f, 0.0f, -1.0f); //背面 glVertex3d(-1.0f, 0.0f, -1.0f); glVertex3d(-1.0f, -1.0f, -1.0f); glVertex3d(0.0f, -1.0f, -1.0f); glEnd(); glPopMatrix(); } void drawBox(double xPos, double yPos, double zPos, double xLen, double yLen, double zLen) { glPushMatrix(); glTranslated(xPos, yPos, zPos); glScaled(xLen, yLen, zLen); drawCube(0, 0, 0); glPopMatrix(); } [/cpp] 然后画小人所需要用到的绘图函数基本就完成了。</p>
<h2 id="小人的组成"><a href="#小人的组成" class="headerlink" title="小人的组成"></a>小人的组成</h2><p>本次试验中，先从简单的情况入手，我先将小人分成了身体、头、左臂、右臂、左腿、右腿五个部分，五个部分用树结构链接，其中身体是根节点，其他的均是其子节点。 <img src="https://bluefissure.com/wp-content/uploads/2017/04/boxman-213x300.png" alt=""> [cpp] Man() { body = Box(Vector3d(1,2,5), Vector3d(1, 2, 3), Vector3d(0,0,0)); body.color = Vector3d(0, 0, 1); int angArm = sin(time/100) <em> 30; int angLeg= sin(time/100) </em> 10; Box *head = new Box(Vector3d(0,-0.5,1),Vector3d(1,1,1)); Box *lArm = new Box(Vector3d(0,0.8,0),Vector3d(0.8,0.8,2), Vector3d(0,1,0), Vector3d(-0.5,0,0), angArm); Box *rArm = new Box(Vector3d(0,-2,0),Vector3d(0.8,0.8,2), Vector3d(0,-1,0), Vector3d(-0.5,0,0), angArm); Box *lLeg = new Box(Vector3d(0,-0.1,-3),Vector3d(0.8,0.8,2), Vector3d(0,-1,0), Vector3d(-0.5,0,0), angLeg); Box *rLeg = new Box(Vector3d(0,-1.1,-3),Vector3d(0.8,0.8,2), Vector3d(0,1,0), Vector3d(-0.5,0,0), angLeg); body.addNxt(head); body.addNxt(lArm); body.addNxt(rArm); body.addNxt(lLeg); body.addNxt(rLeg); } [/cpp] 注意下这两句 [cpp] int angArm = sin(time/100) * 30; int angLeg= sin(time/100) <em> 10; [/cpp] 计算了胳膊和腿根据time的摆动（旋转）角度，需要注意的是，在后面调用时注意其正负号，避免出现顺拐的情况(x 其中，Box是一个封装起来的长方体，主要包括了一个长方体、颜色、旋转点、旋转轴、存储树结构的指针数组等。 [cpp] class Box { public: int len; double angle; Vector3d base, scale, rotN, color, rotP; Box</em> nxt[maxnxt]; Box() { angle = 0; len = 0; color = Vector3d(1, 1, 1); rotP = Vector3d(0, 0, 0); }; Box(Vector3d base_, Vector3d scale_, Vector3d rotN_=Vector3d(0,0,0), Vector3d rotP_=Vector3d(0,0,0), double angle_=0, Vector3d color_ = Vector3d(1, 1, 1)) { angle = angle_; base = base_; scale = scale_; rotN = rotN_; len = 0; rotP = rotP_; color = color_; } void draw() { glPushMatrix(); if (rotN.norm() != 0) { glTranslated(rotP.x(), rotP.y(), rotP.z()); //平移到旋转点 glRotated(angle, rotN.x(), rotN.y(), rotN.z()); //旋转 glTranslated(-rotP.x(), -rotP.y(), -rotP.z()); //平移回去 } glColor3d(color.x(), color.y(), color.z()); glTranslated(base.x(), base.y(), base.z()); drawBox(Vector3d(0,0,0),scale); for (int i = 0; i &lt; len; i++) { glPushMatrix(); nxt[i]-&gt;draw(); glPopMatrix(); } glPopMatrix(); } void addNxt(Box *x) { nxt[len] = x; len++; } }; [/cpp]     大部分的组成都介绍的差不多了，当然这个系统还是比较简单，调试时除了写相机系统时由于没有坐标系没有很方便的找出错误，另外深度测试时卡了一会儿之外剩下的还算蛮顺利，具体代码请移步<a href="https://github.com/Bluefissure/WalkingMan" target="_blank" rel="noopener">github</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/02/computer-graphics-experiment-ii/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/02/computer-graphics-experiment-ii/" itemprop="url">Computer Graphics Experiment II Part.1 3D Touring</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-02T23:35:34+00:00">
                2017-04-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>图形学实验二，主要是写了3D的空间漫游以及Walking Boxman两个东西，用了一下午加一晚上。 先放一下效果：(我大B站时不时傲娇，加载不出来播放器的话烦请移步<a href="http://www.bilibili.com/video/av9570127/" target="_blank" rel="noopener">av9570127</a>)  然后具体的实现主要分为两部分，3D场景漫游和机器人的绘画与动作，本篇博文先着重介绍3D漫游部分，机器人部分留作下一篇博文再做介绍。</p>
<h2 id="UNV相机及变换"><a href="#UNV相机及变换" class="headerlink" title="UNV相机及变换"></a>UNV相机及变换</h2><p>首先UNV相机主要由三个单位向量表示：</p>
<ul>
<li>$\\overrightarrow { n } $:指向目标的视线向量</li>
<li>$\\overrightarrow { u } $:指向相机右方的向量</li>
<li>$\\overrightarrow { v } $:指向相机上方的向量</li>
</ul>
<p>而这三个组成的向量可以由下面三个向量（点）来求得：</p>
<ul>
<li>$\\overrightarrow { pos } $:相机位置</li>
<li>$\\overrightarrow { target } $:视线目标位置</li>
<li>$\\overrightarrow { up } $:指向空间上方的向量</li>
</ul>
<p>具体的计算公式为： <script type="math/tex">\\begin{cases} \\overrightarrow { n } =\\overrightarrow { target } -\\overrightarrow { pos }  \\\ \\overrightarrow { u } =\\overrightarrow { up } \\times \\overrightarrow { n }  \\\ \\overrightarrow { v } =\\overrightarrow { u } \\times \\overrightarrow { n }  \\end{cases}</script> 有了这几个向量，我们就可以首先实现平移变换了： [cpp] void GLCamera::slide(float du, float dv, float dn,float dup) { m_pos(0) = m_pos(0) + du*u.x() + dv*v.x() + dn*n.x() + dup*m_up.x(); m_pos(1) = m_pos(1) + du*u.y() + dv*v.y() + dn*n.y() + dup*m_up.y(); m_pos(2) = m_pos(2) + du*u.z() + dv*v.z() + dn*n.z() + dup*m_up.z(); m_target(0) = m_target(0) + du*u.x() + dv*v.x() + dn*n.x() + dup*m_up.x(); m_target(1) = m_target(1) + du*u.y() + dv*v.y() + dn*n.y() + dup*m_up.y(); m_target(2) = m_target(2) + du*u.z() + dv*v.z() + dn*n.z() + dup*m_up.z(); } [/cpp] 其中，du dv dn dup分别是在$\\overrightarrow { u } $, $\\overrightarrow { v } $, $\\overrightarrow { n } $, $\\overrightarrow { up } $向量方向上面的平移距离。 然后将键盘的按键事件与函数绑定，在display函数中调用glulookAt函数就好了： [cpp] gluLookAt(cam.m_pos.x(), cam.m_pos.y(), cam.m_pos.z(), cam.m_target.x(), cam.m_target.y(), cam.m_target.z(), cam.m_up.x(), cam.m_up.y(), cam.m_up.z()) [/cpp]</p>
<h2 id="鼠标的移动与视野变换"><a href="#鼠标的移动与视野变换" class="headerlink" title="鼠标的移动与视野变换"></a>鼠标的移动与视野变换</h2><p>鼠标的移动产生视野的变换似乎是一个比较麻烦的事情，但是实际上这种视野的变换无非是一系列对unv三个向量的旋转操作，下面从两个维度说明下鼠标的移动对视野产生的影响应该怎么计算： <img src="https://bluefissure.com/wp-content/uploads/2017/04/unv.png" alt=""></p>
<h3 id="x方向变化——鼠标左右移动"><a href="#x方向变化——鼠标左右移动" class="headerlink" title="x方向变化——鼠标左右移动"></a>x方向变化——鼠标左右移动</h3><p>如图，结合我们多年守望先锋的经验，左右移动鼠标是$\\overrightarrow { u } $ $\\overrightarrow { n } $ 两个向量绕着$\\overrightarrow { v } $ 进行旋转，实际上，我们只需要将$\\overrightarrow { n } $进行旋转后计算出旋转后对应的$\\overrightarrow { target } $向量，并重新应用之前的计算公式计算$\\overrightarrow { u } $ $\\overrightarrow { n } $ $\\overrightarrow { v } $。</p>
<h3 id="y方向变化——鼠标上下移动"><a href="#y方向变化——鼠标上下移动" class="headerlink" title="y方向变化——鼠标上下移动"></a>y方向变化——鼠标上下移动</h3><p>同样的，结合我们多年76对空打法鸡的经验，上下移动鼠标是$\\overrightarrow { v } $ $\\overrightarrow { n } $ 两个向量绕着$\\overrightarrow { u } $ 进行旋转，实际上，我们也只需要将$\\overrightarrow { n } $进行旋转后计算出旋转后对应的$\\overrightarrow { target } $向量，并重新应用之前的计算公式计算$\\overrightarrow { u } $ $\\overrightarrow { n } $ $\\overrightarrow { v } $。   注意下代码中的$x$ $y$和上面所说的$x$ $y$是反的，由于默认的二维数组是$x$为行，$y$为列…… [cpp] void passiveMotion(int x, int y) { GLint deltax = oldx - x; GLint deltay = oldy - y; GLfloat xAngle = 360 <em> (GLfloat)deltay / (GLfloat)WinH; GLfloat yAngle = 360 </em> (GLfloat)deltax / (GLfloat)WinW; yAngle = 360 - yAngle; xAngle = 360 - xAngle; glPushMatrix(); glLoadIdentity(); glRotated(xAngle, cam.u.x(), cam.u.y(), cam.u.z());//上下移动 glRotated(yAngle, cam.v.x(), cam.v.y(), cam.v.z());//左右移动 GLfloat m[16]; glGetFloatv(GL_MODELVIEW_MATRIX, m); glPopMatrix(); Eigen::Matrix3d rot; for (int i = 0; i &lt; 3; i++) { for (int j = 0; j &lt; 3; j++) { rot(i, j) = m[i <em> 4 + j]; } } cam.n = rot</em>cam.n; cam.m_target = Eigen::Vector3d(cam.m_pos.x() - cam.n.x(), cam.m_pos.y() - cam.n.y(), cam.m_pos.z() - cam.n.z()); cam.upduvn(); oldx = x; oldy = y; glutPostRedisplay(); } [/cpp]   到这里这个项目的目前实现了的3D漫游功能和实现的过程就差不多介绍完了，还有很多的相机旋转的函数并没有在这里用到，更具体的代码请移步<a href="https://github.com/Bluefissure/WalkingMan" target="_blank" rel="noopener">github</a> 下一篇博文——<a href="https://bluefissure.com/archives/261" target="_blank" rel="noopener">3D Boxman</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/06/google-kickstart-round-a-2017/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/06/google-kickstart-round-a-2017/" itemprop="url">Google  Kickstart Round A 2017</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-06T21:23:07+00:00">
                2017-03-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>好辣鸡啊……第一题推了一个小时后后期瞬间爆炸……太久不敲代码了已经成了咸鱼干…… 今天补了一下题，在这里记录一下。 <a href="https://codejam.withgoogle.com/codejam/contest/dashboard?c=8284486#s=p0" target="_blank" rel="noopener">Problem A. Square Counting</a></p>
<h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>Mr. Panda has recently fallen in love with a new game called Square Off, in which players compete to find as many different squares as possible on an evenly spaced rectangular grid of dots. To find a square, a player must identify four dots that form the vertices of a square. Each side of the square must have the same length, of course, but it does not matter what that length is, and the square does not necessarily need to be aligned with the axes of the grid. The player earns one point for every different square found in this way. Two squares are different if and only if their sets of four dots are different. Mr. Panda has just been given a grid with <strong>R</strong> rows and <strong>C</strong> columns of dots. How many different squares can he find in this grid? Since the number might be very large, please output the answer modulo 109 + 7 (1000000007).</p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>The first line of the input gives the number of test cases, <strong>T</strong>. <strong>T</strong> lines follow. Each line has two integers <strong>R</strong> and <strong>C</strong>: the number of dots in each row and column of the grid, respectively.</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>For each test case, output one line containing <code>Case #x: y</code>, where <code>x</code> is the test case number (starting from 1) and <code>y</code> is the number of different squares can be found in the grid.</p>
<h3 id="Limits"><a href="#Limits" class="headerlink" title="Limits"></a>Limits</h3><p>1 ≤ <strong>T</strong> ≤ 100.</p>
<h4 id="Small-dataset"><a href="#Small-dataset" class="headerlink" title="Small dataset"></a>Small dataset</h4><p>2 ≤ <strong>R</strong> ≤ 1000. 2 ≤ <strong>C</strong> ≤ 1000.</p>
<h4 id="Large-dataset"><a href="#Large-dataset" class="headerlink" title="Large dataset"></a>Large dataset</h4><p>2 ≤ <strong>R</strong> ≤ 109. 2 ≤ <strong>C</strong> ≤ 109.</p>
<h3 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h3><p>Input</p>
<p>Output</p>
<p>4<br>2 4<br>3 4<br>4 4<br>1000 500</p>
<p>Case #1: 3<br>Case #2: 10<br>Case #3: 20<br>Case #4: 624937395</p>
<p>The pictures below illustrate the grids from the three sample cases and a valid square in the third sample case. <img src="https://codejam.withgoogle.com/codejam/contest/images/?image=sample1.png&amp;p=5680283126857728&amp;c=8284486" alt=""> <img src="https://codejam.withgoogle.com/codejam/contest/images/?image=sample2.png&amp;p=5680283126857728&amp;c=8284486" alt=""> <img src="https://codejam.withgoogle.com/codejam/contest/images/?image=sample3.png&amp;p=5680283126857728&amp;c=8284486" alt="">   <strong>题目大意：</strong> 给出一个$ n \\times m$的正方形点阵，也就是$ (n-1) \\times (m-1) $的棋盘，问存在多少个格点正方形（注意如最后一个图的倾斜的正方形也要计算） <strong>做法：</strong> 默默推公式……一开始没注意倾斜的正方形导致方向错了好久，之后推导的过程还算顺利……叭（哭） <strong>推导过程：</strong> 首先，我们考虑$ i \\times i$的方阵中存在多少能够“充满”整个方阵的格点多边形，“充满”意味着不会存在某一行或者某一列的方格与正方形没有相交的部分，我们先看$ i = 5$的情况：</p>
<p><img src="https://bluefissure.com/wp-content/uploads/2017/03/1-300x296.png" alt=""> 为了方便我们考虑所有的情况，上图举了个倾斜的例子。 对于边长是$i$的方阵，我们有$p + q = i$，因此我们只需要统计方程$p + q = i$有多少非负整数解，显然有$i+1$种，但是$\\begin{cases} p=i \\\ q=0 \\end{cases}$和$\\begin{cases} p=0 \\\ q=i \\end{cases}$是同一种，因此总共有$i$种情况，而$n$行存在$n-i+1$个长度为$i$的方阵，$m$列存在$m-i+1$个长度为$i$的方阵，乘起来求和最终结果是：<script type="math/tex">\\sum _{ i=1 }^{ min(n,m) }{ i\\times (n-i+1)\\times (m-i+1) }</script> 这样的结果求小数据是没问题了，大数据还是会TLE，我们需要求出求和公式。 求和公式的求法就不在这儿详述了，懒的话直接用<a href="http://www.wolframalpha.com/input/?i=sum(i*(n-i%2B1" target="_blank" rel="noopener">WolframAlpha</a><em>(m-i%2B1),i,1,m))求也行。 最后公式是：(假设m<n) 12="" $$\\frac="" {="" (2n-m+1)\\cdot="" (m+1)\\cdot="" (m+2)\\cdot="" m="" }{="" }="" $$="" 取模过程的分母12的话逆元也好直接除也好，自行处理都不难：="" \[cpp\]="" #include<bits="" stdc++.h=""> using namespace std; #define LL long long const LL MOD=1000000007; LL exgcd(LL a,LL b,LL &amp;x,LL &amp;y) { if(a==0&amp;&amp;b==0) return -1; if(!b){ x=1;y=0; return a; } LL ans=exgcd(b,a%b,y,x); y-=x</n)></em>(a/b); return ans; } LL inv(LL a,LL mod) { LL x,y; LL d=exgcd(a,mod,x,y); if(d==1) return (x+mod)%mod; else return -1; } int main() { int T; LL N,M; scanf(“%d”,&amp;T); LL inv12=inv(12,MOD); for(int cas=1;cas&lt;=T;cas++){ scanf(“%lld%lld”,&amp;N,&amp;M); N—,M—; if(N&lt;M) swap(N,M); LL ans=(2*N+1-M)%MOD*(M+1)%MOD<em>(M+2)%MOD\</em>M%MOD*inv12%MOD; (ans+=MOD)%=MOD; printf(“Case #%d: %lld\\n”,cas,ans); } return 0; } [/cpp] <a href="https://codejam.withgoogle.com/codejam/contest/dashboard?c=8284486#s=p1" target="_blank" rel="noopener">Problem B. Patterns Overlap</a></p>
<h3 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem"></a>Problem</h3><p>Alice likes reading and buys a lot of books. She stores her books in two boxes; each box is labeled with a pattern that matches the titles of all of the books stored in that box. A pattern consists of only uppercase/lowercase English alphabet letters and stars (<code>*</code>). A star can match between zero and four letters. For example, books with the titles <code>GoneGirl</code> and <code>GoneTomorrow</code> can be put in a box with the pattern <code>Gone**</code>, but books with the titles <code>TheGoneGirl</code>, and <code>GoneWithTheWind</code> cannot. Alice is wondering whether there is any book that could be stored in either of the boxes. That is, she wonders if there is a title that matches both boxes’ patterns.</p>
<h3 id="Input-1"><a href="#Input-1" class="headerlink" title="Input"></a>Input</h3><p>The first line of the input gives the number of test cases, <strong>T</strong>. <strong>T</strong> test cases follow. Each consists of two lines; each line has one string in which each character is either an uppercase/lowercase English letter or <code>*</code>.</p>
<h3 id="Output-1"><a href="#Output-1" class="headerlink" title="Output"></a>Output</h3><p>For each test case, output one line containing <code>Case #x: y</code>, where <code>x</code> is the test case number (starting from 1) and <code>y</code> is <code>TRUE</code> if there is a string that matches both patterns, or <code>FALSE</code> if not.</p>
<h3 id="Limits-1"><a href="#Limits-1" class="headerlink" title="Limits"></a>Limits</h3><p>1 ≤ <strong>T</strong> ≤ 50.</p>
<h4 id="Small-dataset-1"><a href="#Small-dataset-1" class="headerlink" title="Small dataset"></a>Small dataset</h4><p>1 ≤ the length of each pattern ≤ 200. Each pattern contains at most 5 stars.</p>
<h4 id="Large-dataset-1"><a href="#Large-dataset-1" class="headerlink" title="Large dataset"></a>Large dataset</h4><p>1 ≤ the length of each pattern ≤ 2000.</p>
<h3 id="Sample-1"><a href="#Sample-1" class="headerlink" title="Sample"></a>Sample</h3><p>Input</p>
<p>Output</p>
<p>3<br>****<br>It<br>Shakes<em>e<br>S</em>speare<br>Shakes<em>e
</em>peare</p>
<p>Case #1: TRUE<br>Case #2: TRUE<br>Case #3: FALSE</p>
<p><strong>题目大意：</strong> 给了两个模式串，类似通配符的方式，<em>能代表任意0~4个字符，问是否存在一个字符串能同时匹配这两个模式串。 <strong>做法：</strong> 啊竟然是dp，首先把每个</em>扩展成4个，然后用一个dp转移方程xjb转移就行，复杂度是$O({ n }^{ 2 })$的，讲道理最坏情况是$8000 \\times 8000$，但是大数据跑了6s也是能得到结果……讲道理大数据的实现是8min呢…… 转移的过程如下：用$dp[i][j]$表示$s$串匹配到$i$，$p$串匹配到$j$能否成功匹配： <script type="math/tex">if\\quad dp\[i\]\[j\]\\quad then\\\ \\quad \\quad \\quad \\quad \\begin{cases} dp\[i+1\]\[j\]|=s\[i+1\]=='*' \\\ dp\[i\]\[j+1\]|=p\[j+1\]=='*' \\\ dp\[i+1\]\[j+1\]|=s\[i+1\]=='*'||p\[j+1\]=='*'||s\[i+1\]==p\[j+1\] \\end{cases}</script> 简单解释下转移方程，首先，如果$s$的第$i+1$位是’<em>‘，那么可以从前一位$[i][j]$的状态转移过来，$p$同理，另外，如果$s[i+1]==p[j+1]$，状态也是可以可达的。 [cpp] #include <bits stdc++.h=""> using namespace std; #define MAXN 10000 char s[MAXN],p[MAXN],t[MAXN]; bool f[MAXN][MAXN]; int main(){ int T,len,ls,lp; scanf(“%d”,&amp;T); for(int cas=1;cas&lt;=T;cas++){ scanf(“%s”,t); len=strlen(t); ls=lp=0; for(int i=0;i&lt;len;i++) if(t[i]==’</bits></em>‘) for(int k=4;k;k—) s[++ls]=0; else s[++ls]=t[i]; scanf(“%s”,t); len=strlen(t); for(int i=0;i&lt;len;i++) if(t[i]==’*’) for(int k=4;k;k—) p[++lp]=0; else p[++lp]=t[i]; for(int i=0;i&lt;=ls;i++) for(int j=0;j&lt;=lp;j++) f[i][j]=0; f[0][0]=1; for(int i=0;i&lt;=ls;i++) for(int j=0;j&lt;=lp;j++) if(f[i][j]){ f[i+1][j]|=!s[i+1]; f[i][j+1]|=!p[j+1]; f[i+1][j+1]|=!s[i+1]||!p[j+1]||s[i+1]==p[j+1]; } printf(“Case #%d: “,cas); puts(f[ls][lp]?”TRUE”:”FALSE”); } return 0; } [/cpp] <a href="https://codejam.withgoogle.com/codejam/contest/dashboard?c=8284486#s=p2" target="_blank" rel="noopener">Problem C. Space Cubes</a></p>
<h2 id="Problem-2"><a href="#Problem-2" class="headerlink" title="Problem"></a>Problem</h2><p>“Look at the stars, look how they shine for you.” - Coldplay, “Yellow” In a galaxy far, far away, there are many stars. Each one is a sphere with a certain position (in three-dimensional space) and radius. It is possible for stars to overlap each other. The stars are so incredibly beautiful to you that you want to capture them forever! You would like to build two cubes of the same integer edge length, and place them in space such that for each star, there is at least one cube that _completely_ contains it. (It’s not enough for a star to be completely contained by the union of the two cubes.) A star is completely contained by a cube if no point on the star is outside the cube; a point exactly on a cube face is still considered to be inside the cube. The cubes can be placed anywhere in space, but they must be placed with their edges parallel to the coordinate axes. It is acceptable for the cubes to overlap stars or each other. What is the minimum integer edge length that allows you to achieve this goal?</p>
<h3 id="Input-2"><a href="#Input-2" class="headerlink" title="Input"></a>Input</h3><p>The input starts with one line containing exactly one integer <strong>T</strong>, which is the number of test cases. <strong>T</strong> test cases follow. Each test case begins with a line containing an integer, <strong>N</strong>, representing the number of stars. This is followed by <strong>N</strong> lines. On the ith line, there are 4 space-separated integers, <strong>Xi</strong>, <strong>Yi</strong>, <strong>Zi</strong>and <strong>Ri</strong>, indicating the (X, Y, Z) coordinates of the center of the <strong>ith</strong> star, and the radius of the <strong>ith</strong> star.</p>
<h3 id="Output-2"><a href="#Output-2" class="headerlink" title="Output"></a>Output</h3><p>For each test case, output one line containing <code>Case #x: y</code>, where <code>x</code> is the test case number (starting from 1) and <code>y</code> is the minimum cube edge length that solves the problem, as described above.</p>
<h3 id="Limits-2"><a href="#Limits-2" class="headerlink" title="Limits"></a>Limits</h3><p>1 ≤ <strong>T</strong> ≤ 100.<br>-108 ≤ <strong>Xi</strong> ≤ 108, for all i.<br>-108 ≤ <strong>Yi</strong> ≤ 108, for all i.<br>-108 ≤ <strong>Zi</strong> ≤ 108, for all i.<br>1 ≤ <strong>Ri</strong> ≤ 108, for all i.</p>
<h4 id="Small-dataset-2"><a href="#Small-dataset-2" class="headerlink" title="Small dataset"></a>Small dataset</h4><p>1 ≤ <strong>N</strong> ≤ 16.</p>
<h4 id="Large-dataset-2"><a href="#Large-dataset-2" class="headerlink" title="Large dataset"></a>Large dataset</h4><p>1 ≤ <strong>N</strong> ≤ 2000.</p>
<h3 id="Sample-2"><a href="#Sample-2" class="headerlink" title="Sample"></a>Sample</h3><p>Input</p>
<p>Output</p>
<p>3<br>3<br>1 1 1 1<br>2 2 2 1<br>4 4 4 1<br>3<br>1 1 1 2<br>2 3 4 1<br>5 6 7 1<br>3<br>1 1 1 1<br>1 1 1 1<br>9 9 9 1</p>
<p>Case #1: 3<br>Case #2: 5<br>Case #3: 2</p>
<p><strong>题目大意：</strong> 三维空间给$n$个球，用两个相同的cube包含所有的球，求cube的最小棱长。 <strong>做法：</strong> 首先求出来最小包围cube，然后枚举两个cube在最小包围cube的八个顶点的哪个位置，对于每种情况二分棱长。 （感谢qqq的思路……没想到会这么简单……） [cpp] #include<bits stdc++.h=""> using namespace std; #define MAXN 10010 #define LL long long #define INF 0xfffffffffffffff int n; struct pl { LL x,y,z,r; }p[2010]; struct cb { LL mx,my,mz; LL Mx,My,Mz; void init(){ mx=my=mz=INF; Mx=My=Mz=-INF; } void input(pl p){ mx=min(mx,p.x-p.r); my=min(my,p.y-p.r); mz=min(mz,p.z-p.r); Mx=max(Mx,p.x+p.r); My=max(My,p.y+p.r); Mz=max(Mz,p.z+p.r); } }c; bool incube(pl p,cb c) { bool f=c.mx&lt;=(p.x-p.r)&amp;&amp;(p.x+p.r)&lt;=c.Mx; f&amp;=c.my&lt;=(p.y-p.r)&amp;&amp;(p.y+p.r)&lt;=c.My; f&amp;=c.mz&lt;=(p.z-p.r)&amp;&amp;(p.z+p.r)&lt;=c.Mz; return f; } bool check(int i,int j,LL l) { cb c1,c2; if(i&amp;1){ c1.mx=c.mx; c1.Mx=c1.mx+l; }else{ c1.Mx=c.Mx; c1.mx=c1.Mx-l; } if(i&amp;2){ c1.my=c.my; c1.My=c1.my+l; }else{ c1.My=c.My; c1.my=c1.My-l; } if(i&amp;4){ c1.mz=c.mz; c1.Mz=c1.mz+l; }else{ c1.Mz=c.Mz; c1.mz=c1.Mz-l; } if(j&amp;1){ c2.mx=c.mx; c2.Mx=c2.mx+l; }else{ c2.Mx=c.Mx; c2.mx=c2.Mx-l; } if(j&amp;2){ c2.my=c.my; c2.My=c2.my+l; }else{ c2.My=c.My; c2.my=c2.My-l; } if(j&amp;4){ c2.mz=c.mz; c2.Mz=c2.mz+l; }else{ c2.Mz=c.Mz; c2.mz=c2.Mz-l; } for(int i=0;i<n;i++){ if(!incube(p\[i\],c1)&&!incube(p\[i\],c2))="" return="" 0;="" }="" 1;="" int="" main()="" {="" t;="" scanf("%d",&t);="" for(int="" cas="1;cas<=T;cas++){" scanf("%d",&n);="" c.init();="" i="0;i<n;i++){" scanf("%lld%lld%lld%lld",&p\[i\].x,&p\[i\].y,&p\[i\].z,&p\[i\].r);="" c.input(p\[i\]);="" ll="" ex,ey,ez;="" ex="max(c.Mx-c.mx,c.Mx-c.mx);" ey="max(c.My-c.my,c.My-c.my);" ez="max(c.Mz-c.mz,c.Mz-c.mz);" rr="max(ex,max(ey,ez));" printf("rr:%lld\\n",rr);="" ans="INF;" j="0;j<8;j++){" l="0,r=rr;" while(l<r-1){="" mid="l+((r-l)">&gt;1); if(check(i,j,mid)) r=mid; else l=mid+1; } for(;check(i,j,r-1);r—); ans=min(ans,r); } } printf(“Case #%d: %lld\\n”,cas,ans); } return 0; } [/cpp]</n;i++){></bits></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/11/python-e6-a8-a1-e6-8b-9f-e7-99-bb-e9-99-86-e5-88-9d-e6-8e-a2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/11/python-e6-a8-a1-e6-8b-9f-e7-99-bb-e9-99-86-e5-88-9d-e6-8e-a2/" itemprop="url">Python模拟登陆初探</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-11T17:08:23+00:00">
                2017-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Uncategorized/" itemprop="url" rel="index">
                    <span itemprop="name">Uncategorized</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>　　嘛，学校上线了新的教务系统和选课系统，然后之前的刷课之类的脚本就要重写辣。之前的版本是学长用Java写的一个模拟登陆之类的脚本，然而作为两年都没用Java写过工程类代码的我来说，“人生苦短，我用Python”，于是便花了四个小时写了个新的脚本，具体的方式在这里记录一下，供自己以后回顾以及萌萌哒学弟学妹们参考。</p>
<p>　　Update: 还是requests方便……</p>
<p>　　首先，我也是第一次写这种带些“黑科技”性质的脚本，如果有不完善的地方欢迎大家提出问题，进行讨论。大体的思路是：设定一个间隔时间，不断地查询某个课程的剩余容量，发现有课余量的时候便开始选课。</p>
<p>　　因此，脚本需要实现的主要有三个模块：模拟登陆模块、查询课余量模块、选课模块，下面分别对三个模块进行说明：</p>
<h2 id="模拟登陆"><a href="#模拟登陆" class="headerlink" title="模拟登陆"></a>模拟登陆</h2><p>我们先来看一下登录界面 <img src="https://bluefissure.com/wp-content/uploads/2017/01/QQ截图20170111133144-300x119.png" alt=""> 啊，大概长这样，在cmd里ping一下域名找到IP <img src="https://bluefissure.com/wp-content/uploads/2017/01/QQ图片20170111160011-300x73.png" alt=""> 然后打开Wireshark，对IP地址添加filter，过滤掉其他信息 <img src="https://bluefissure.com/wp-content/uploads/2017/01/QQ截图20170111160649-300x72.png" alt=""> 刷新网页，登录，则记录了通信过程的数据包（121开头的IP为本机，202为网站的IP） <img src="https://bluefissure.com/wp-content/uploads/2017/01/QQ图片20170111160936-300x54.png" alt=""> 很明显带着login的那个东西传送的是登录信息，打开看看： 果然，直接POST了一个类型为application/x-www-form-urlencoded的数据给了子目录/b/ajaxLogin，数据内容为 [python] “j_username” = “学号” “j_password” = “密码” [/python] 于是，我们同样的将数据以这种形式封装，并用Python模拟HTTP请求发送给<a href="http://bkjwxk.sdu.edu.cn/b/ajaxLogin" target="_blank" rel="noopener">http://bkjwxk.sdu.edu.cn/b/ajaxLogin</a> [python] def login(username,password): urlLogin=’<a href="http://bkjwxk.sdu.edu.cn/b/ajaxLogin" target="_blank" rel="noopener">http://bkjwxk.sdu.edu.cn/b/ajaxLogin</a>‘ data = { “j_username”: username, “j_password”: password, } data = urllib.parse.urlencode(data).encode(‘utf-8’) #注意编码 try: headers = { ‘Content-Type’: ‘application/x-www-form-urlencoded’, ‘User-Agent’: ‘Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36’, ‘Accept’: ‘<em>/</em>‘, ‘Origin’: ‘<a href="http://bkjwxk.sdu.edu.cn" target="_blank" rel="noopener">http://bkjwxk.sdu.edu.cn</a>‘, ‘Connection’: ‘keep-alive’, ‘Accept-Language’: ‘zh-CN,zh;q=0.8’, ‘Accept-Encoding’:’ gzip, deflate’, ‘Host’: ‘bkjwxk.sdu.edu.cn’ } request = urllib.request.Request(url=urlLogin, headers=headers, data=data) cookie = http.cookiejar.CookieJar() opener = urllib.request.build_opener(urllib.request.HTTPCookieProcessor(cookie)) r = opener.open(request) response = r.read().decode(‘utf-8’) #注意解码 print(response) if(response!=’”success”‘): print(“登陆失败”) sys.exit() print(“登陆成功”) return cookie; except Exception as e: print(“Login Error: %s”%e) [/python] 几点需要注意的地方：</p>
<ol>
<li>header中的Content-Type最为重要，它规定了数据发送的形式。而header的其他内容加不加好像都可以得到正确的结果</li>
<li>注意cookie的获取和保存，这里使用了http.cookiejar.CookieJar</li>
</ol>
<p>之后，如果登陆成功会返回”success”，不成功则返回了提示信息，我们可以通过打印response来看到。 登陆成功的话，就能返回cookie进行下一步对课程剩余量的爬虫了。</p>
<h2 id="爬取剩余课程容量"><a href="#爬取剩余课程容量" class="headerlink" title="爬取剩余课程容量"></a>爬取剩余课程容量</h2><p>如同刚才的做法，先在网页中模拟对课余量的查询，然后抓包分析数据包内容，这里不再详述，直接看发送和接受的数据包的结果： <img src="https://bluefissure.com/wp-content/uploads/2017/01/kchsearch-300x98.png" alt=""> <img src="https://bluefissure.com/wp-content/uploads/2017/01/kchsearch_res-300x147.png" alt=""> 厉害了，发送格式是application/x-www-form-urlencoded，返回直接返回了json，这样分析就方便多了，具体数据代表的含义的话简单地说一下，具体还是自己抓了包看吧： 发送信息： [python] Form item: “currentPage” = “1” #当前页号 Form item: “kch” = “0063209110” #课程号 [/python] 接受信息： [python] JavaScript Object Notation: application/json Object Member Key: “result” #成功与否 String value: success Member Key: “msg” #不成功的话提示信息 Null value Member Key: “object” #返回数据 Object Member Key: “perPageNum” #每一页的课程数量 Member Key: “totalRows” Member Key: “totalPages” #一共多少页 Member Key: “currentPage” #当前页 Member Key: “prePage” #前一页 Member Key: “nextPage” #后一页 Member Key: “startIndex” #本页开始的Index Member Key: “lastIndex” #本页结束的Index Member Key: “resultList” #结果数组 Array [/python] 然后直接操作json中的Array那个数组，对应的什么KCM属性对应课程名，根据拼音猜一猜就好，找出查询课程的的课序号，如果剩余量大于零则开始选课。 [python] def checkLeft(kch,kxh,cookie): try: urlCheck=’<a href="http://bkjwxk.sdu.edu.cn/b/xk/xs/kcsearch" target="_blank" rel="noopener">http://bkjwxk.sdu.edu.cn/b/xk/xs/kcsearch</a>‘ curPage = 1 totPage = 100 find = False while(curPage &lt;= totPage and not find): # print(“curPage %d”%curPage) # print(“totPage %d”%totPage) # print(“kch %s”%kch) data = { “type”: “kc”, “currentPage”: curPage, “kch”: kch, “jsh”: “”, “skxq”: “”, “skjc”: “”, “kkxsh”: “” } data = urllib.parse.urlencode(data).encode(‘utf-8’) # for item in cookie: # print(‘%s : %s’ % (item.name,item.value)) headers = { ‘Content-Type’: ‘application/x-www-form-urlencoded’, } request = urllib.request.Request(url=urlCheck, headers=headers, data=data) cj = cookie opener = urllib.request.build_opener(urllib.request.HTTPCookieProcessor(cj)) r = opener.open(request) response = r.read().decode(‘utf-8’) if(“login” in response): return False jsondata = json.loads(response) totPage = int(jsondata[“object”][“totalPages”]) curPage = curPage + 1 for item in jsondata[“object”][“resultList”]: if(int(item.get(“KXH”))==int(kxh)): print(item) find = True if(int(item.get(“kyl”))&gt;0): if(xuanke(kch,kxh,cookie)): print(“课程\\”%s\\”选课成功，谢谢使用\\nBy Bluefissure”%(item.get(“KCM”))) sys.exit() else: print(“课程\\”%s\\”课余量不足，您需要等待至少 %s 人退课”%(item.get(“KCM”),-int(item.get(“kyl”))+1)) break if(not find): print(“找不到该课程，请确认课程号、课序号!”) sys.exit() except Exception as e: print(“Check Error: %s”%e) [/python]</p>
<h2 id="选课过程"><a href="#选课过程" class="headerlink" title="选课过程"></a>选课过程</h2><p>选课过程老简单了，直接看抓包的数据如下： <img src="https://bluefissure.com/wp-content/uploads/2017/01/xuanke-300x89.png" alt=""> 老厉害了，直接访问下/b/xk/xs/add/课程号/课序号 就好了，代码太简单都不用贴的…… 然后返回的内容还是json，提示信息是utf-8编码（中文），在wireshark里好像显示不正确： <img src="https://bluefissure.com/wp-content/uploads/2017/01/xuanke_res-300x95.png" alt=""> 在Python里解码就好了： [python] def xuanke(kch,kxh,cookie): try: urlXuanke=’<a href="http://bkjwxk.sdu.edu.cn/b/xk/xs/add/%s/%s&#39;%(kch,kxh" target="_blank" rel="noopener">http://bkjwxk.sdu.edu.cn/b/xk/xs/add/%s/%s&#39;%(kch,kxh</a>) request = urllib.request.Request(url=urlXuanke) cj = cookie opener = urllib.request.build_opener(urllib.request.HTTPCookieProcessor(cj)) r = opener.open(request) response = r.read().decode(‘utf-8’) result = json.loads(response)[“msg”] print(result) return(“选课成功” in result) except Exception as e: print(“Check Error: %s”%e) [/python]</p>
<h2 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h2><ol>
<li>Cookie可能过期，因此每次访问时如果发现有重定向至Login页面的返回时，要重新登录更新cookie</li>
<li>其实系统架构大可不必检测课余量，直接暴力强行选就行，反正新系统的接口这么方便……但是，嘛，总感觉暴力去搞有一些<a href="http://baike.baidu.com/link?url=EhP2CioFsdoTpWoVdS3VPF3pYR5x9WsKurWM51Hnep9oFVsYmIOzvbVRHJ-XhfuwEWo9MhUv1OT_eC8N1oG92a" target="_blank" rel="noopener">DOS</a>的感觉，不要这样搞为好（有人看了这篇博客后去DOS的话那是最骚的）</li>
</ol>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>发现bug的话欢迎来<a href="https://github.com/Bluefissure/XuankeScript" target="_blank" rel="noopener">github</a>提吖，没怎么做测试的说。 另外，本脚本仅做学习交流用途，请勿将其大规模用于实践。 作者并未参与一切类似功能的发行版软件的开发，使用本脚本以及同类发行版软件的责任请由使用者自负。 喵喵。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/19/e8-8e-ab-e6-af-94-e4-b9-8c-e6-96-af-e5-8f-8d-e6-bc-94-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b0/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bluefissure">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bluefissure's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/19/e8-8e-ab-e6-af-94-e4-b9-8c-e6-96-af-e5-8f-8d-e6-bc-94-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b0/" itemprop="url">莫比乌斯反演 学习笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-19T00:04:11+00:00">
                2016-08-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Math-Theory/" itemprop="url" rel="index">
                    <span itemprop="name">Math Theory</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当时数论学到莫比乌斯暂时放下了，现在重新拿起来学习一下</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>已知 <script type="math/tex">F(n)=\\sum_{d\\mid n}f(d)</script> 则有 <script type="math/tex">f(n)=\\sum_{d\\mid n}\\mu(d)F({n\\over d})</script> 其中$\\mu(d)$叫做莫比乌斯函数,其值为<script type="math/tex">\\mu(d)=\\begin{cases} 1 &\\text{d = 1}\\\ (-1)^r &\\text{$d=p\_1p\_2...p\_r,其中p\_i为不同的素数$}\\\ 0 &\\text{else} \\end{cases}</script></p>
<h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><p>1.<script type="math/tex">\\sum _{ d|n }^{  }{ \\mu (d)= } \\begin{cases} 1,\\quad n=1 \\\ 0,\\quad n>1 \\end{cases}\\\</script>证明如下:</p>
<p>$\\bullet$ $n=1$时,显然</p>
<p>$\\bullet$ $n\\neq 1$时,将$n$分解$n={ { p }_{ 1 } }^{ { a }_{ 1 } }{ { p }_{ 2 } }^{ { a }_{ 2 } }…{ { p }_{ k } }^{ { a }_{ k } }$, $\\mu$值不为0的只有质因子次数均为1的因子,其中质因子个数为$r$的因子有$C_{k}^{r}$个,所以<script type="math/tex">\\sum _{ d|n }^{  }{ \\mu (d) } =C_{ k }^{ 0 }-C_{ k }^{ 1 }+C_{ k }^{ 2 }-...+{ (-1) }^{ k }C_{ k }^{ k }=\\sum _{ i=0 }^{ k }{ { (-1) }^{ i }C_{ k }^{ i } } ={ (-1+1) }^{ k }=0</script></p>
<p>2.<script type="math/tex">\\sum _{ d|n }^{  }{ \\frac { \\mu (d) }{ d }  } =\\frac { \\varphi (n) }{ n }\\\</script>证明如下:</p>
<p>由欧拉函数性质知$n=\\sum _{ d|n }^{  }{ \\varphi (n) }$, 设$F(n)=n,\\quad f(n)=\\varphi (n)$, 有$f(n)=\\varphi (n)=\\sum _{ d|n }^{  }{ \\mu (d) } \\cdot \\frac { n }{ d } $,故$\\sum _{ d|n }^{  }{ \\frac { \\mu (d) }{ d }  } =\\frac { \\varphi (n) }{ n } $</p>
<p>3.$\\mu(n)$为积性函数</p>
<h2 id="反演定理的证明"><a href="#反演定理的证明" class="headerlink" title="反演定理的证明"></a>反演定理的证明</h2><p><script type="math/tex">\\begin{align} \\sum _{ d|n }^{  }{ \\mu (d)\\cdot F(\\frac { n }{ d } ) } &=\\sum _{ d|n }^{  }{ \\left\[ \\mu (d)\\sum _{ k|\\frac { n }{ d }  }^{  }{ f(k) }  \\right\]  } \\\ &=\\sum _{ d|n }^{  }{ \\sum _{ d|\\frac { n }{ k }  }^{  }{ \\left\[ \\mu (d)\\cdot f(k) \\right\]  }  } \\\ &=\\sum _{ dk|n }^{  }{ \\left\[ \\mu (d)\\cdot f(k) \\right\]  } \\\ &=\\sum _{ k|n }^{  }{ \\left\[ f(k)\\sum _{ d|\\frac { n }{ k }  }^{  }{ \\mu (d) }  \\right\]  } =f(n) \\end{align}</script> 其中,$\\sum _{ d|\\frac { n }{ k }  }^{  }{ \\mu (d) } $的计算用到了性质1</p>
<h2 id="另一种形式"><a href="#另一种形式" class="headerlink" title="另一种形式"></a>另一种形式</h2><p>莫比乌斯公式还有一种常用的形式较为常用： <script type="math/tex">F(d)=\\sum _{ d|n }^{  }{ f(n) } \\Rightarrow f(d)=\\sum _{ d|n } \\mu ({ \\frac { n }{ d }  })F(n)</script>证明同理 啊,题目明天在写吧……..</p>
<h2 id="题目相关"><a href="#题目相关" class="headerlink" title="题目相关"></a>题目相关</h2><p>嗯，今天做了几道懵逼乌斯的题目感觉的确蛮懵逼的，主要是各种公式的推导过程很是不熟悉，看来还是要多刷题加深对于反演的理解</p>
<h3 id="1-区间内-gcd-x-y-k-对数查询"><a href="#1-区间内-gcd-x-y-k-对数查询" class="headerlink" title="1.区间内$gcd(x,y)=k$对数查询"></a>1.区间内$gcd(x,y)=k$对数查询</h3><p>这是第一类的莫比乌斯反演的应用问题，详细的题意为”求满足$a\\le x\\le b, c\\le y\\le d$范围内，$gcd(x,y)=k$的$(x,y)$数对有多少个”。 首先，我们将问题转化成四个子问题，如果$sol(a,b)$表示$1\\le x\\le a, 1\\le y\\le b$范围内满足题意的$(x,y)$数对有多少个，那么最后的答案$ans$便为<script type="math/tex">ans=sol(b,d)-sol(a-1,d)-sol(c-1,b)+sol(a-1,c-1)</script>于是，我们只需要解决$1\\le x\\le a, 1\\le y\\le b$范围内$gcd(x,y)=k$的个数。 显然，这个问题等价于$1\\le x\\le \\frac { a }{ k } ,1\\le y\\le \\frac { b }{ k } $范围内$gcd(x,y)=1$的个数。 于是，我们考虑这个元问题：$1\\le x\\le n ,1\\le y\\le m $范围内$gcd(x,y)=1$的个数 不妨假设$n\\le m$ 我们用$f(k)$表示$gcd(x,y)=k$的个数，用$F(k)$表示$k|gcd(x,y)$的个数，则有<script type="math/tex">F(d)=\\sum _{ d|n }^{  }{ f(n) }</script> 显然<script type="math/tex">F(x)=\\left\\lfloor \\frac { n }{ x }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ x }  \\right\\rfloor</script>根据反演公式<script type="math/tex">f(i)=\\sum _{ i|d } \\mu ({ \\frac { d }{ i }  })F(d)=\\sum _{ i|d } \\mu ({ \\frac { d }{ i }  })\\cdot \\left\\lfloor \\frac { n }{ d }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ d }  \\right\\rfloor</script>有<script type="math/tex">f(1)=\\sum _{ d\\le n } \\mu ({ d })\\cdot \\left\\lfloor \\frac { n }{ d }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ d }  \\right\\rfloor</script>于是我们枚举一下$d$就能得出结果啦。 等等，枚举？范围稍稍大一点就铁定TLE啊，我们考虑<script type="math/tex">\\left\\lfloor \\frac { n }{ d }  \\right\\rfloor</script>这个东西，显然他不是随着$d$的变化一定都变化的，而是只会有$O(\\sqrt { n } )$个取值，具体的原因在新生赛热身的<a href="http://sduoj.org/problem/20/" target="_blank" rel="noopener">这道题</a> 的题解中有简单提到。因此，我们对<script type="math/tex">\\left\\lfloor \\frac { n }{ d }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ d }\\right\\rfloor</script>这个东西相同取值的块求区间内$\\mu $的和即可，在实际的操作过程中只需要维护一个$\\mu $的前缀和。 代码以 <a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2301" target="_blank" rel="noopener">BZOJ_2301</a> 为例 [cpp]#include<iostream> #include<cstdio> #include<cstring> #include<string> #include<algorithm> using namespace std; int a,b,c,d,k; #define N 100100 #define LL long long int prim[N], phi[N] = {1,1}, mob[N]={1,1}; bool vis[N]; int pn = 0; LL sum[N]; void table(){ memset(vis, 0, sizeof(vis)); mob[1]=1; for(int i = 2;i &lt; N;i++){ if(!vis[i]) { prim[pn++] = i; phi[i] = i-1; mob[i] = -1; } for(int j = 0;j &lt; pn &amp;&amp; 1LL*i*prim[j] &lt; N;j++){ if(i % prim[j] == 0){ phi[i*prim[j]] = phi[i] * prim[j]; vis[i*prim[j]] = 1; mob[i*prim[j]] = 0; break; } phi[i*prim[j]] = phi[i] * (prim[j]-1); vis[i*prim[j]] = 1; mob[i*prim[j]] = -mob[i]; } } sum[0]=0; for(int i=1;i<n;i++) sum\[i\]="sum\[i-1\]+mob\[i\];" }="" ll="" sol(int="" n,int="" m)="" {="" int="" last;="" ret="0;" if(n="">m) swap(n,m); for(int i=1;i&lt;=n;i=last+1){ last=min(n/(n/i),m/(m/i)); ret+=(LL)(n/i)<em>(m/i)</em>(sum[last]-sum[i-1]); } return ret; } int main() { int T; table(); for(scanf(“%d”,&amp;T);T—;){ scanf(“%d%d%d%d%d”,&amp;a,&amp;b,&amp;c,&amp;d,&amp;k); LL ans=sol(b/k,d/k)-sol((a-1)/k,d/k)-sol((c-1)/k,b/k)+sol((a-1)/k,(c-1)/k); printf(“%lld\\n”,ans); } return 0; } [/cpp]  </n;i++)></algorithm></string></cstring></cstdio></iostream></p>
<h3 id="2-区间内-gcd-x-y-为质数的对数查询"><a href="#2-区间内-gcd-x-y-为质数的对数查询" class="headerlink" title="2.区间内$gcd(x,y)$为质数的对数查询"></a>2.区间内$gcd(x,y)$为质数的对数查询</h3><p>同1.可转化成元问题：$1\\le x\\le n ,1\\le y\\le m $范围内$gcd(x,y)$为质数的$(x,y)$数对个数 $(n\\le m)$ 一个非常直观（或说偷懒）的办法就是对于所有的质数$p$满足$p\\le n$我们用1.的方法搞出$gcd(x,y)=p$的个数然后加起来……啊喂怎么可能这么简单辣…… 但是这个想法给了我们一个思路，我们先来看<script type="math/tex">f(p)=\\sum _{ d\\le n/p }^{  }{ \\mu (d)\\cdot \\left\\lfloor \\frac { n/p }{ d }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m/p }{ d }  \\right\\rfloor = } \\sum _{ d\\le n/p }^{  }{ \\mu (d)\\cdot \\left\\lfloor \\frac { n }{ pd }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ pd }  \\right\\rfloor  }</script>令$T=pd$，有<script type="math/tex">f(p)=\\sum _{ d\\le n/p }^{  }{ \\mu (\\frac { T }{ p } )\\cdot \\left\\lfloor \\frac { n }{ T }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ T }  \\right\\rfloor  }</script>有<script type="math/tex">\\begin{align} \\sum _{ p\\le n }^{  }{ f(p) } &=\\sum _{ p\\le n }^{  }{ \\sum _{ d\\le n/p }^{  }{ \\mu (\\frac { T }{ p } )\\cdot \\left\\lfloor \\frac { n }{ T }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ T }  \\right\\rfloor  }  } \\\ &=\\sum _{ T=1 }^{ n }{ \\sum _{ p|T }^{  }{ \\mu (\\frac { T }{ p } )\\cdot \\left\\lfloor \\frac { n }{ T }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ T }  \\right\\rfloor  }  } \\\ &=\\sum _{ T=1 }^{ n }{ \\left\\lfloor \\frac { n }{ T }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ T }  \\right\\rfloor \\sum _{ p|T }^{  }{ \\mu (\\frac { T }{ p } ) }  }  \\end{align}</script>（以上$p$均为质数，下同） $\\left\\lfloor \\frac { n }{ T }  \\right\\rfloor \\cdot \\left\\lfloor \\frac { m }{ T }  \\right\\rfloor $可以分块来搞，后面的这个$\\sum _{ p|T }^{  }{ \\mu (\\frac { T }{ p } ) } $就不太好弄了，我们先来研究一下它</p>
<h4 id="函数-g-x-sum-p-x-mu-frac-x-p"><a href="#函数-g-x-sum-p-x-mu-frac-x-p" class="headerlink" title="函数$g(x)=\\sum _{ p|x }^{  }{ \\mu (\\frac { x }{ p } ) } $"></a>函数$g(x)=\\sum _{ p|x }^{  }{ \\mu (\\frac { x }{ p } ) } $</h4><p>首先，我们先来说它的计算过程中用到的一个性质，之后再给出证明<script type="math/tex">g(kp)=\\begin{cases} \\mu (k),\\quad p\\mid k \\\ \\mu (k)-g(k),\\quad p\\nmid k \\end{cases}</script> 证明：首先<script type="math/tex">g(kp)=\\sum _{ p'|kp }^{  }{ \\mu (\\frac { kp }{ p' } ) }</script> （$p’$为质数，下同）我们把$k$分解<script type="math/tex">k={ p }^{ a }\\cdot { p }_{ 1 }^{ { a }_{ 1 } }\\cdot { p }_{ 2 }^{ { a }_{ 2 } }...{ p }_{ r }^{ { a }_{ r } }</script> 1.当$p|k$时，有$a\\ge 1$故<script type="math/tex">kp={ p }^{ a+1 }\\cdot { p }_{ 1 }^{ { a }_{ 1 } }\\cdot { p }_{ 2 }^{ { a }_{ 2 } }...{ p }_{ r }^{ { a }_{ r } }</script>由$\\mu$的定义可知，只有$p’=p$时，$\\mu (\\frac { kp }{ p’ } ) $才不等于0（否则$p$的指数比1大），所以此时<script type="math/tex">\\sum _{ p'|kp }^{  }{ \\mu (\\frac { kp }{ p' } ) } =\\mu (k)</script> 2.当$p\\nmid k$时 $p’=p$时，同上文：<script type="math/tex">\\mu (\\frac { kp }{ p' } )=\\mu (k)</script> $p’\\ne p$时，因为$\\mu $是一个积性函数，并且$p\\nmid \\frac { k }{ p’ } $，所以有<script type="math/tex">\\mu (\\frac { kp }{ p' } )=\\mu (\\frac { k }{ p' } )\\cdot \\mu(p)</script>有<script type="math/tex">g(kp){ | }_{ p\\ne p' }=\\sum _{ p'|kp,p'\\ne p }^{  }{ \\mu (\\frac { kp }{ p' } ) } =\\sum _{ p'|kp,p'\\ne p }^{  }{ \\mu (\\frac { k }{ p' } )\\cdot \\mu (p) } =\\mu (p)\\cdot \\sum _{ p'|k }^{  }{ \\mu (\\frac { k }{ p' } ) }</script>而<script type="math/tex">\\mu (p)=-1,\\sum _{ p'|k }^{  }{ \\mu (\\frac { k }{ p' } ) } =g(k)</script>所以<script type="math/tex">g(kp){ | }_{ p\\ne p' }=-g(k)</script> 上面两个加起来，就得到了<script type="math/tex">\\mu (k)-g(k),\\quad p\\nmid k</script> 综上，<script type="math/tex">g(kp)=\\begin{cases} \\mu (k),\\quad p\\mid k \\\ \\mu (k)-g(k),\\quad p\\nmid k \\end{cases}</script>   回想一下我们线性筛的过程，发现对于$p|k$和$p\\nmid k$的讨论正是线性筛的过程，因此我们可以预处理出$g(x)$，然后的做法就和问题1差不多了，具体的预处理过程看代码还是。 貌似一道叫做 YY的GCD 的题目成了权限题，于是代码只好以 <a href="http://www.spoj.com/problems/PGCD/" target="_blank" rel="noopener">SPOJ_PGCD </a>为例 [cpp]#include<iostream> #include<cstdio> #include<cstring> #include<string> #include<algorithm> using namespace std; int a,b,c,d,k; #define N 10000005 #define LL long long int prim[N], phi[N] = {1,1}, mob[N]={1,1},g[N]; bool vis[N]; int pn = 0; LL sum[N]; void table(){ memset(vis, 0, sizeof(vis)); mob[1]=1; g[1]=1; for(int i = 2;i &lt; N;i++){ if(!vis[i]) { prim[pn++] = i; phi[i] = i-1; mob[i] = -1; g[i] = 1; } for(int j = 0;j &lt; pn &amp;&amp; 1LL*i*prim[j] &lt; N;j++){ if(i % prim[j] == 0){ phi[i*prim[j]] = phi[i] * prim[j]; vis[i*prim[j]] = 1; mob[i*prim[j]] = 0; g[i*prim[j]] = mob[i]; break; } phi[i*prim[j]] = phi[i] <em> (prim[j]-1); vis[i\</em>prim[j]] = 1; mob[i*prim[j]] = -mob[i]; g[i*prim[j]] = mob[i] - g[i]; } } sum[0]=0; for(int i=1;i<n;i++) sum\[i\]="sum\[i-1\]+g\[i\];" }="" ll="" sol(int="" n,int="" m)="" {="" int="" last;="" ret="0;" if(n="">m) swap(n,m); for(int i=1;i&lt;=n;i=last+1){ last=min(n/(n/i),m/(m/i)); ret+=(LL)(n/i)*(m/i)<em>(sum[last]-sum[i-1]); } return ret-(LL)m</em>n; } int main() { int T,cas=1; table(); for(scanf(“%d”,&amp;T);T—;){ scanf(“%d%d”,&amp;a,&amp;b); LL ans; ans=sol(a,b); printf(“%lld\\n”,ans); } return 0; }[/cpp]</n;i++)></algorithm></string></cstring></cstdio></iostream></p>
<h3 id="3-还有好多其他类型的题，到时候单独写博客吧……我也没做完……"><a href="#3-还有好多其他类型的题，到时候单独写博客吧……我也没做完……" class="headerlink" title="3.还有好多其他类型的题，到时候单独写博客吧……我也没做完……"></a>3.还有好多其他类型的题，到时候单独写博客吧……我也没做完……</h3><p>收尾的话差不多了，总结的话有时间再写，打那么多公式简直累死了……</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Bluefissure</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bluefissure</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
